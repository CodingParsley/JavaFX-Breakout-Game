package application;

import javafx.stage.Stage;
import javafx.scene.Node;
import javafx.scene.Scene;
import javafx.scene.input.KeyCode;
import javafx.scene.input.KeyEvent;
import javafx.scene.layout.Pane;
import javafx.scene.shape.Rectangle;
import javafx.application.Application;
import javafx.event.EventHandler;

import java.util.Optional;

import gameComponenets.BarebonesLevelPicker;
import gameComponenets.Button;
import gameComponenets.Coordinate;
import gameComponenets.RectangleType;
import gameComponenets.Variables;

public class LevelsScreenView extends Application {
	private Stage window;
	Runnable changeLevelTo;
	private Scene scene;
	private Pane layout;
	BarebonesLevelPicker bblp;

	public LevelsScreenView(BarebonesLevelPicker bblp){
		this.bblp=bblp;
	}

	@Override
	public void start(Stage primaryStage) throws Exception {
		window = primaryStage;
		window.setResizable(false);

		layout = new Pane();

		scene = new Scene(layout, Variables.getWIDTH(), Variables.getHEIGHT());

		window.setScene(scene);
		window.show();
	}

	public void drawArrayOfButtons(gameComponenets.Button[][] buttonArray) {
		// find a graphical Button in children where r.Id = gr.Id
		// if it isn't there, create one and add it to children
		// then...
		//
		// gr.setwidth, etc. according to r
		for (int column = 0; column < buttonArray.length; column++) {

			for (int row = 0; row < buttonArray[column].length; row++) {

				int finalRow = row+1;
				int finalColumn = column+1;
				gameComponenets.Button b = buttonArray[column][row];
				Optional<Node> graphicalbuttonNode = layout.getChildren().stream().filter(n -> n instanceof Rectangle)
						.filter(n -> n.getId().equals(Integer.toString(b.getId()))).findFirst();
				Button graphicalbutton = null;
				if (graphicalbuttonNode.isPresent()) {
					graphicalbutton = (Rectangle) (graphicalbuttonNode.get());
				} else {
					graphicalbutton = new Rectangle();
					layout.getChildren().add(graphicalbutton);
				}
				// If statements are here for making the Button graphical

				graphicalbutton.setId(Integer.toString(b.getId()));
				graphicalbutton.setWidth(b.getWidth());
				graphicalbutton.setHeight(b.getHeight());
				graphicalbutton.setTranslateX(b.getTopLeftCoordinate().getX());
				graphicalbutton.setTranslateY(b.getTopLeftCoordinate().getY());
				graphicalbutton.setOnMouseClicked(e -> {

				});
			}
		}

	}
}
