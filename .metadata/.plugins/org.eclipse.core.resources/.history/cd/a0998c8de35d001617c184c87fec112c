package application;

import javafx.stage.Stage;
import javafx.scene.Node;
import javafx.scene.Scene;
import javafx.scene.input.KeyCode;
import javafx.scene.input.KeyEvent;
import javafx.scene.layout.Pane;
import javafx.scene.shape.Rectangle;
import javafx.application.Application;
import javafx.event.EventHandler;

import java.util.Optional;

import gameComponenets.BarebonesLevelPicker;
import gameComponenets.Button;
import gameComponenets.Coordinate;
import gameComponenets.Variables;

public class LevelsScreenView extends Application {
	private Stage window;
	Runnable changeLevelTo;
	private Scene scene;
	private Pane layout;
	BarebonesLevelPicker bblp;

	public LevelsScreenView(BarebonesLevelPicker bblp){
		this.bblp=bblp;
	}

	@Override
	public void start(Stage primaryStage) throws Exception {
		window = primaryStage;
		window.setResizable(false);

		layout = new Pane();

		scene = new Scene(layout, Variables.getWIDTH(), Variables.getHEIGHT());

		window.setScene(scene);
		window.show();
	}

	public void drawArrayOfRectangles(gameComponenets.Rectangle[][] rectArray) {
		// find a graphical rectangle in children where r.Id = gr.Id
		// if it isn't there, create one and add it to children
		// then...
		//
		// gr.setwidth, etc. according to r
		for (int column = 0; column < rectArray.length; column++) {

			for (int row = 0; row < rectArray[column].length; row++) {

				int finalRow = row+1;
				int finalColumn = column+1;
				gameComponenets.Rectangle r = rectArray[column][row];
				Optional<Node> graphicalRectNode = layout.getChildren().stream().filter(n -> n instanceof Rectangle)
						.filter(n -> n.getId().equals(Integer.toString(r.getId()))).findFirst();
				Rectangle graphicalRect = null;
				if (graphicalRectNode.isPresent()) {
					graphicalRect = (Rectangle) (graphicalRectNode.get());
				} else {
					graphicalRect = new Rectangle();
					layout.getChildren().add(graphicalRect);
				}
				// If statements are here for making the rectangle graphical

				graphicalRect.setId(Integer.toString(r.getId()));
				graphicalRect.setWidth(r.getWidth());
				graphicalRect.setHeight(r.getHeight());
				graphicalRect.setTranslateX(r.getTopLeftCoordinate().getX());
				graphicalRect.setTranslateY(r.getTopLeftCoordinate().getY());
				graphicalRect.setOnMouseClicked(e -> {
				});
			}
		}

	}
}
